"0","# Reproducible workflow function for any species"
"0","suitable_aqua <- function(species, tempmin, tempmax, depthmin, depthmax) {"
"0","  rcl_fun <- matrix(c(-Inf, tempmin, NA,"
"0","                  tempmin, tempmax, 1,"
"0","                  tempmax, Inf, NA), ncol = 3, byrow = TRUE)"
"0","  sst_binary_fun <- reclassify(mean_sst, rcl = rcl_fun)"
"0","  rcl_fun = matrix(c(-Inf, depthmin, NA,"
"0","                 depthmin, depthmax, 1, "
"0","                 depthmax, Inf, NA), ncol = 3, byrow = TRUE)"
"0","  depth_binary_fun <- reclassify(depth, rcl = rcl_fun)"
"0","  raster_mask_fun <- overlay(sst_binary_fun, depth_binary_fun, fun = '*')"
"0","  raster_mask_fun <- crop(raster_mask_fun, eez)"
"0","  if (all(unique(raster_mask_fun) %in% c(1, NA))) {"
"0","  } else {stop(""Error in code. Mask contains values other than 1 or NA."")}"
"0","  cell_areas_fun <- cellStats(raster_mask_fun, stat = ""sum"", na.rm = TRUE)"
"0","  cell_areas_raster_fun <- raster(raster_mask_fun)"
"0","  cell_areas_raster_fun[] <- cell_areas_fun"
"0","  eez_raster_fun <- rasterize(eez, raster_mask_fun)"
"0","  total_suitable_area_fun <- zonal(cell_areas_raster_fun, eez_raster_fun, fun = sum, na.rm = TRUE)"
"0","  percent_suitable_area_fun <- (total_suitable_area_fun / eez$area_m2) * 100"
"0","  eez_joined_fun <- cbind(eez, total_suitable_area_fun, percent_suitable_area_fun) %>%"
"0","    mutate(""Suitable area (km^2)"" = value / 1000000) %>%"
"0","    mutate(""Percent suitable"" = value.1) %>% "
"0","    dplyr::select(-value, -value.1, -zone, -zone.1)"
"0","  if (any(eez_joined_fun$`Percent suitable` < 0 | eez_joined_fun$`Percent suitable` > 100)) {"
"0","    stop(""Error in code. At least one percent area is not between 0 and 100."")"
"0","  } else {}"
"0","  CA <- us_states %>%"
"0","    filter(NAME == ""California"")"
"0","  OR <- us_states %>%"
"0","    filter(NAME == ""Oregon"")"
"0","  WA <- us_states %>%"
"0","    filter(NAME == ""Washington"")"
"0","  bbox_new_fun <- st_bbox(eez)"
"0","  xrange_fun <- bbox_new_fun$xmax - bbox_new_fun$xmin"
"0","  bbox_new_fun[3] <- bbox_new_fun[3] + (0.9 * xrange_fun)"
"0","  bbox_new_fun <- bbox_new_fun %>%"
"0","    st_as_sfc()"
"0","  total_area_map_fun <-"
"0","    tm_shape(eez_joined_fun, bbox = bbox_new_fun) +"
"0","    tm_fill(""Suitable area (km^2)"", palette=""Reds"", style = ""equal"", n=6) +"
"0","    tm_borders() +"
"0","    tm_shape(CA) +"
"0","    tm_borders() +"
"0","    tm_shape(OR) +"
"0","    tm_borders() +"
"0","    tm_shape(WA) +"
"0","    tm_borders() +"
"0","    tm_compass(position = c(""left"", ""bottom"")) +"
"0","    tm_scale_bar(position = c(""left"", ""bottom"")) +"
"0","    tm_layout(title = paste(""Suitable area for"", species,""aquaculture"")) +"
"0","    tm_layout(legend.position = c(""right"", ""center"")) +"
"0","    tm_layout(inner.margins = 0.15)"
"0","  percent_area_map_fun <- "
"0","    tm_shape(eez_joined_fun, bbox = bbox_new_fun) +"
"0","    tm_fill(""Percent suitable"", palette=""BuPu"", style = ""equal"", n=6) +"
"0","    tm_borders() +"
"0","    tm_shape(CA) +"
"0","    tm_borders() +"
"0","    tm_shape(OR) +"
"0","    tm_borders() +"
"0","    tm_shape(WA) +"
"0","    tm_borders() +"
"0","    tm_compass(position = c(""left"", ""bottom"")) +"
"0","    tm_scale_bar(position = c(""left"", ""bottom"")) +"
"0","    tm_layout(title = paste(""Suitable area for"", species,""aquaculture"")) +"
"0","    tm_layout(legend.position = c(""right"", ""center"")) +"
"0","    tm_layout(inner.margins = 0.15)"
"0","  return(tmap_arrange(total_area_map_fun, percent_area_map_fun))}"
